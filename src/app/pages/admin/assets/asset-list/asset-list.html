<div class="max-w-7xl mx-auto font-sans p-4 space-y-6" (click)="closeAllDropdowns()">

    <!-- HEADER -->
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
        <div>
            <h1 class="text-2xl font-bold text-gray-900 tracking-tight">Data Aset AC</h1>
            <p class="text-sm text-gray-500 mt-1">Kelola {{ allAssets.length }} unit pendingin ruangan terdaftar.</p>
        </div>

        <div class="flex items-center gap-3">
            <!-- VIEW SWITCHER - Outline Style -->
            <div class="border border-gray-200 p-1 rounded-xl flex items-center text-xs font-bold bg-white">
                <button (click)="viewMode = 'list'"
                    class="px-4 py-2 rounded-lg transition-all duration-200 flex items-center gap-2"
                    [ngClass]="viewMode === 'list' ? 'bg-blue-50 text-blue-700 border border-blue-200 shadow-sm' : 'text-gray-400 hover:text-gray-600'">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor"
                        stroke-width="2" viewBox="0 0 24 24">
                        <line x1="8" y1="6" x2="21" y2="6"></line>
                        <line x1="8" y1="12" x2="21" y2="12"></line>
                        <line x1="8" y1="18" x2="21" y2="18"></line>
                        <line x1="3" y1="6" x2="3.01" y2="6"></line>
                        <line x1="3" y1="12" x2="3.01" y2="12"></line>
                        <line x1="3" y1="18" x2="3.01" y2="18"></line>
                    </svg>
                    List
                </button>
                <button (click)="viewMode = 'visual'"
                    class="px-4 py-2 rounded-lg transition-all duration-200 flex items-center gap-2"
                    [ngClass]="viewMode === 'visual' ? 'bg-blue-50 text-blue-700 border border-blue-200 shadow-sm' : 'text-gray-400 hover:text-gray-600'">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor"
                        stroke-width="2" viewBox="0 0 24 24">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="12" y1="3" x2="12" y2="21"></line>
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                    </svg>
                    Visual
                </button>
            </div>

            <a routerLink="/admin/assets/new"
                class="flex border-2 border-blue-700 text-blue-700 hover:bg-blue-50 px-5 py-2.5 rounded-xl font-bold items-center gap-2 transition-all shadow-sm">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor"
                    stroke-width="3" viewBox="0 0 24 24">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                Tambah Aset
            </a>
        </div>
    </div>

    <!-- ADVANCED FILTER BAR -->
    <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100 mb-6">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">

            <!-- Search -->
            <div class="lg:col-span-1 relative">
                <div class="absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none text-gray-400">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" stroke="currentColor"
                        stroke-width="2" viewBox="0 0 24 24">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                </div>
                <input type="text" placeholder="Cari No Aset / SKU..." (input)="setName($event)"
                    class="w-full pl-10 pr-4 py-2.5 rounded-xl border border-gray-200 focus:border-blue-500 focus:ring-4 focus:ring-blue-50 outline-none transition-all text-sm font-medium text-gray-700">
            </div>

            <!-- Location Filter -->
            <div class="relative group">
                <button (click)="toggleLocationDropdown(); $event.stopPropagation()" type="button"
                    class="w-full px-4 py-2.5 rounded-xl border border-gray-200 hover:border-blue-300 hover:bg-gray-50 flex items-center justify-between transition-all outline-none">
                    <div class="flex items-center gap-2 text-gray-500">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" stroke="currentColor"
                            stroke-width="2" viewBox="0 0 24 24">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                            <circle cx="12" cy="10" r="3"></circle>
                        </svg>
                        <span class="text-sm font-bold text-gray-700 truncate">{{ selectedLocation === 'Semua' ?
                            'Semua Lokasi' : selectedLocation }}</span>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" class="text-gray-400">
                        <path d="M6 9l6 6 6-6" />
                    </svg>
                </button>

                <!-- Location Filter Dropdown -->
                <div *ngIf="locationDropdownOpen" (click)="$event.stopPropagation()"
                    class="absolute z-50 mt-2 w-full bg-white rounded-xl shadow-xl border border-gray-100 py-1 max-h-64 overflow-y-auto">
                    <button (click)="selectLocation('Semua')" type="button"
                        class="w-full px-4 py-2 text-left hover:bg-blue-50 transition-colors text-sm font-bold"
                        [class.bg-blue-50]="selectedLocation === 'Semua'"
                        [class.text-blue-700]="selectedLocation === 'Semua'"
                        [class.text-gray-600]="selectedLocation !== 'Semua'">
                        Semua Lokasi
                    </button>
                    <button *ngFor="let loc of locations" (click)="selectLocation(loc)" type="button"
                        class="w-full px-4 py-2 text-left hover:bg-blue-50 transition-colors text-sm font-bold"
                        [class.bg-blue-50]="selectedLocation === loc" [class.text-blue-700]="selectedLocation === loc"
                        [class.text-gray-600]="selectedLocation !== loc">
                        {{ loc }}
                    </button>
                </div>
            </div>

            <!-- Brand Filter -->
            <div class="relative group">
                <button (click)="toggleBrandDropdown(); $event.stopPropagation()" type="button"
                    class="w-full px-4 py-2.5 rounded-xl border border-gray-200 hover:border-blue-300 hover:bg-gray-50 flex items-center justify-between transition-all outline-none">
                    <div class="flex items-center gap-2 text-gray-500">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" stroke="currentColor"
                            stroke-width="2" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M12 8v8M8 12h8"></path>
                        </svg>
                        <span class="text-sm font-bold text-gray-700 truncate">{{ selectedBrand === 'Semua' ? 'Semua
                            Merk' : selectedBrand }}</span>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" class="text-gray-400">
                        <path d="M6 9l6 6 6-6" />
                    </svg>
                </button>

                <div *ngIf="brandDropdownOpen" (click)="$event.stopPropagation()"
                    class="absolute z-50 mt-2 w-full bg-white rounded-xl shadow-xl border border-gray-100 py-1 max-h-64 overflow-y-auto">
                    <button (click)="selectBrand('Semua')" type="button"
                        class="w-full px-4 py-2 text-left hover:bg-blue-50 transition-colors text-sm font-bold"
                        [class.bg-blue-50]="selectedBrand === 'Semua'" [class.text-blue-700]="selectedBrand === 'Semua'"
                        [class.text-gray-600]="selectedBrand !== 'Semua'">
                        Semua Merk
                    </button>
                    <button *ngFor="let brand of brands" (click)="selectBrand(brand)" type="button"
                        class="w-full px-4 py-2 text-left hover:bg-blue-50 transition-colors text-sm font-bold"
                        [class.bg-blue-50]="selectedBrand === brand" [class.text-blue-700]="selectedBrand === brand"
                        [class.text-gray-600]="selectedBrand !== brand">
                        {{ brand }}
                    </button>
                </div>
            </div>

            <!-- Status Filter -->
            <div class="relative group">
                <button (click)="toggleStatusDropdown(); $event.stopPropagation()" type="button"
                    class="w-full px-4 py-2.5 rounded-xl border border-gray-200 hover:border-blue-300 hover:bg-gray-50 flex items-center justify-between transition-all outline-none">
                    <div class="flex items-center gap-2 text-gray-500">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" stroke="currentColor"
                            stroke-width="2" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="12"></line>
                        </svg>
                        <span class="text-sm font-bold text-gray-700 truncate">
                            {{ selectedStatus === 'Semua' ? 'Semua Status' : (selectedStatus === 'good' ? 'Normal' :
                            selectedStatus === 'maintenance' ? 'Maintenance' : 'Rusak') }}
                        </span>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" class="text-gray-400">
                        <path d="M6 9l6 6 6-6" />
                    </svg>
                </button>

                <div *ngIf="statusDropdownOpen" (click)="$event.stopPropagation()"
                    class="absolute z-50 mt-2 w-full bg-white rounded-xl shadow-xl border border-gray-100 py-1 overflow-hidden">
                    <button (click)="selectStatus('Semua')" type="button"
                        class="w-full px-4 py-2 text-left hover:bg-blue-50 transition-colors text-sm font-bold text-gray-600">Semua
                        Status</button>
                    <button (click)="selectStatus('good')" type="button"
                        class="w-full px-4 py-2 text-left hover:bg-green-50 transition-colors text-sm font-bold text-green-600 border-l-4 border-transparent hover:border-green-600">Normal</button>
                    <button (click)="selectStatus('maintenance')" type="button"
                        class="w-full px-4 py-2 text-left hover:bg-amber-50 transition-colors text-sm font-bold text-amber-600 border-l-4 border-transparent hover:border-amber-600">Maintenance</button>
                    <button (click)="selectStatus('broken')" type="button"
                        class="w-full px-4 py-2 text-left hover:bg-red-50 transition-colors text-sm font-bold text-red-600 border-l-4 border-transparent hover:border-red-600">Rusak</button>
                </div>
            </div>

        </div>

        <!-- PAGINATION CONTROLS (TOP) -->
        <div *ngIf="viewMode === 'list' && !loading && filteredAssets.length > 0"
            class="px-6 py-4 bg-white rounded-2xl border border-gray-100 flex items-center justify-between">
            <div class="text-xs font-bold text-gray-400">
                Menampilkan {{ (currentPage - 1) * itemsPerPage + 1 }} - {{ (currentPage * itemsPerPage >
                filteredAssets.length) ? filteredAssets.length : currentPage * itemsPerPage }} dari {{
                filteredAssets.length }} Data
            </div>
            <div class="flex gap-2">
                <button (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1"
                    class="px-3 py-1.5 rounded-lg border border-gray-200 text-xs font-bold text-gray-500 hover:bg-white hover:text-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all">
                    Sebelumnya
                </button>
                <div class="flex items-center gap-1">
                    <button *ngFor="let p of [].constructor(totalPages); let i = index" (click)="changePage(i + 1)"
                        class="w-8 h-8 rounded-lg flex items-center justify-center text-xs font-bold transition-all"
                        [ngClass]="currentPage === (i + 1) ? 'bg-blue-600 text-white shadow-sm' : 'text-gray-400 hover:text-gray-600 hover:bg-gray-50'">
                        {{ i + 1 }}
                    </button>
                </div>
                <button (click)="changePage(currentPage + 1)" [disabled]="currentPage === totalPages"
                    class="px-3 py-1.5 rounded-lg border border-gray-200 text-xs font-bold text-gray-500 hover:bg-white hover:text-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all">
                    Selanjutnya
                </button>
            </div>
        </div>

        <!-- === MODE 1: LIST / TABLE === -->
        <div *ngIf="viewMode === 'list'" class="animate-fade-in">
            <div *ngIf="!loading && filteredAssets.length > 0"
                class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full text-left border-collapse">
                        <thead>
                            <tr
                                class="bg-gray-50 border-b border-gray-200 text-gray-500 text-[11px] uppercase tracking-wider font-bold">
                                <th class="px-6 py-4 w-12 text-center">#</th>
                                <th class="px-6 py-4">Informasi Aset</th>
                                <th class="px-6 py-4">Lokasi</th>
                                <th class="px-6 py-4">Status</th>
                                <th class="px-6 py-4">Nilai Buku (Est)</th>
                                <th class="px-6 py-4 text-right">Aksi</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-100">
                            <tr *ngFor="let asset of paginatedAssets; let i = index"
                                class="group hover:bg-gray-50 transition-colors duration-200">
                                <td class="px-6 py-4 text-center">
                                    <span class="font-semibold text-gray-400 text-xs">{{ (currentPage - 1) *
                                        itemsPerPage + i + 1 }}</span>
                                </td>
                                <td class="px-6 py-4">
                                    <div class="flex items-center gap-3">
                                        <div
                                            class="w-10 h-10 rounded-lg bg-blue-50 text-blue-700 flex items-center justify-center border border-blue-100 p-2">
                                            <!-- Icon Switcher based on Type -->
                                            <ng-container [ngSwitch]="getAssetType(asset)">

                                                <!-- CASSETTE (Ceiling) -->
                                                <svg *ngSwitchCase="'cassette'" xmlns="http://www.w3.org/2000/svg"
                                                    width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                                                    <path
                                                        d="M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32Zm0,176H48V48H208V208ZM128,48v160m-80-80H208"
                                                        fill="none" stroke="currentColor" stroke-linecap="round"
                                                        stroke-linejoin="round" stroke-width="16"></path>
                                                </svg>

                                                <!-- STANDING (Floor) -->
                                                <svg *ngSwitchCase="'standing'" xmlns="http://www.w3.org/2000/svg"
                                                    width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                                                    <rect x="56" y="32" width="144" height="192" rx="8" fill="none"
                                                        stroke="currentColor" stroke-linecap="round"
                                                        stroke-linejoin="round" stroke-width="16"></rect>
                                                    <line x1="56" y1="80" x2="200" y2="80" fill="none"
                                                        stroke="currentColor" stroke-linecap="round"
                                                        stroke-linejoin="round" stroke-width="16"></line>
                                                    <line x1="104" y1="160" x2="152" y2="160" fill="none"
                                                        stroke="currentColor" stroke-linecap="round"
                                                        stroke-linejoin="round" stroke-width="16"></line>
                                                </svg>

                                                <!-- SPLIT (Default/Wall) -->
                                                <svg *ngSwitchDefault xmlns="http://www.w3.org/2000/svg" width="20"
                                                    height="20" fill="currentColor" viewBox="0 0 256 256">
                                                    <path
                                                        d="M224,112V88a16,16,0,0,0-16-16H48A16,16,0,0,0,32,88v24a16,16,0,0,0,16,16h4.13A40,40,0,0,0,88,168h80a40,40,0,0,0,35.87-40H208A16,16,0,0,0,224,112ZM168,152H88a24,24,0,0,1-23.47-19.1A8.25,8.25,0,0,0,64,132a8,8,0,0,0-8-8H48V88H208v36h-8a8,8,0,0,0-8,8,8.25,8.25,0,0,0-.53.9A24,24,0,0,1,168,152Z">
                                                    </path>
                                                </svg>
                                            </ng-container>
                                        </div>
                                        <div>
                                            <div class="font-bold text-gray-900 text-sm">{{ asset.name }}</div>
                                            <div
                                                class="text-[10px] text-gray-500 font-medium leading-none mt-0.5 uppercase tracking-wide">
                                                {{ asset.brand }} â€¢ {{ asset.sku }}</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-6 py-4">
                                    <div class="flex items-center gap-1.5 text-gray-600 text-xs font-semibold">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none"
                                            stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                            <circle cx="12" cy="10" r="3"></circle>
                                        </svg>
                                        {{ asset.location }}
                                    </div>
                                </td>
                                <td class="px-6 py-4">
                                    <span
                                        class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded border-2 text-[10px] font-extrabold uppercase tracking-wider bg-white"
                                        [ngClass]="{
                                            'text-green-600 border-green-600': asset.status === 'good',
                                            'text-red-600 border-red-600': asset.status === 'broken',
                                            'text-amber-600 border-amber-600': asset.status === 'maintenance'
                                        }">
                                        <div class="w-1.5 h-1.5 rounded-full" [ngClass]="{
                                            'bg-green-600': asset.status === 'good',
                                            'bg-red-600': asset.status === 'broken',
                                            'bg-amber-600': asset.status === 'maintenance'
                                        }"></div>
                                        {{ asset.status === 'good' ? 'Normal' : (asset.status === 'broken' ? 'Rusak' :
                                        'Service') }}
                                    </span>
                                </td>
                                <td class="px-6 py-4">
                                    <div class="text-xs font-bold text-gray-700">
                                        {{ calculateBookValue(asset) | currency:'IDR':'symbol':'1.0-0' }}
                                    </div>
                                    <div class="text-[10px] text-gray-400 font-medium">
                                        Beli: {{ (asset.purchase_price || 0) | currency:'IDR':'symbol':'1.0-0' }}
                                    </div>
                                </td>
                                <td class="px-6 py-4 text-right">
                                    <div class="flex items-center justify-end gap-2">
                                        <a [routerLink]="['/admin/assets/print', asset.id]" target="_blank"
                                            class="p-2 rounded-lg border border-gray-200 text-gray-500 hover:border-blue-600 hover:text-blue-600 transition-all bg-white"
                                            title="Print QR">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none"
                                                stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                                <polyline points="6 9 6 2 18 2 18 9"></polyline>
                                                <path
                                                    d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2">
                                                </path>
                                                <rect x="6" y="14" width="12" height="8"></rect>
                                            </svg>
                                        </a>
                                        <a [routerLink]="['/admin/assets/edit', asset.id]"
                                            class="p-2 rounded-lg border border-gray-200 text-blue-600 hover:border-blue-600 hover:bg-blue-50 transition-all bg-white"
                                            title="Edit">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none"
                                                stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7">
                                                </path>
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z">
                                                </path>
                                            </svg>
                                        </a>
                                        <button (click)="openDisposalModal(asset)" type="button"
                                            class="p-2 rounded-lg border border-gray-200 text-red-600 hover:border-red-600 hover:bg-red-50 transition-all bg-white"
                                            title="Write-off / Musnahkan">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none"
                                                stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
                                                <polyline points="3 6 5 6 21 6"></polyline>
                                                <path
                                                    d="M19 6V20a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                                                </path>
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- PAGINATION CONTROLS -->
                <div class="px-6 py-4 border-t border-gray-100 bg-gray-50 flex items-center justify-between">
                    <div class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">
                        Hal {{ currentPage }} dari {{ totalPages }}
                    </div>
                    <div class="flex gap-1.5">
                        <button (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1"
                            class="px-3 py-1.5 rounded-lg border border-gray-200 text-xs font-semibold text-gray-600 hover:bg-white disabled:opacity-50 transition-all">
                            Prev
                        </button>
                        <div class="flex items-center gap-1">
                            <button *ngFor="let p of [].constructor(totalPages); let i = index"
                                (click)="changePage(i + 1)"
                                class="w-8 h-8 rounded-lg flex items-center justify-center text-xs font-bold transition-all"
                                [ngClass]="currentPage === (i + 1) ? 'bg-blue-700 text-white shadow-sm' : 'text-gray-400 hover:text-gray-700'">
                                {{ i + 1 }}
                            </button>
                        </div>
                        <button (click)="changePage(currentPage + 1)" [disabled]="currentPage === totalPages"
                            class="px-3 py-1.5 rounded-lg border border-gray-200 text-xs font-semibold text-gray-600 hover:bg-white disabled:opacity-50 transition-all">
                            Next
                        </button>
                    </div>
                </div>
            </div>
        </div>


        <!-- === MODE 2: VISUAL MAP === -->
        <div *ngIf="viewMode === 'visual'" class="space-y-6 animate-fade-in">

            <!-- Legend -->
            <div class="flex justify-center gap-6 text-[10px] font-bold text-gray-400 uppercase tracking-widest">
                <div class="flex items-center gap-2">
                    <div class="w-2.5 h-2.5 rounded-full bg-green-500"></div> Normal
                </div>
                <div class="flex items-center gap-2">
                    <div class="w-2.5 h-2.5 rounded-full bg-red-500"></div> Rusak
                </div>
                <div class="flex items-center gap-2">
                    <div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div> Maintenance
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                <ng-container *ngFor="let loc of (selectedLocation === 'Semua' ? locations : [selectedLocation])">
                    <div *ngIf="getAssetsByLocation(loc).length > 0"
                        class="bg-white rounded-xl p-5 shadow-sm border border-gray-200 flex flex-col hover:shadow-md transition-shadow">

                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-bold text-gray-900 text-sm truncate flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none"
                                    stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" class="text-blue-700">
                                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                    <circle cx="12" cy="10" r="3"></circle>
                                </svg>
                                {{ loc }}
                            </h3>
                            <span class="text-[10px] font-bold text-gray-400">{{ getAssetsByLocation(loc).length }}
                                unit</span>
                        </div>

                        <div class="grid grid-cols-3 gap-2">
                            <div *ngFor="let asset of getAssetsByLocation(loc)"
                                class="flex flex-col items-center group cursor-pointer"
                                [routerLink]="['/admin/assets/edit', asset.id]">

                                <div class="w-full aspect-video rounded-lg flex items-center justify-center transition-all duration-200 border-2"
                                    [ngClass]="{
                                    'bg-white border-green-600 text-green-600': asset.status === 'good',
                                    'bg-white border-red-600 text-red-600 animate-pulse': asset.status === 'broken',
                                    'bg-white border-amber-500 text-amber-500': asset.status === 'maintenance'
                                }">
                                    <ng-container [ngSwitch]="getAssetType(asset)">
                                        <!-- CASSETTE (Ceiling/Central - Square) -->
                                        <svg *ngSwitchCase="'cassette'" xmlns="http://www.w3.org/2000/svg" width="20"
                                            height="20" fill="currentColor" viewBox="0 0 256 256">
                                            <rect x="32" y="32" width="192" height="192" rx="8" fill="none"
                                                stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                                stroke-width="16"></rect>
                                            <circle cx="128" cy="128" r="32" fill="none" stroke="currentColor"
                                                stroke-linecap="round" stroke-linejoin="round" stroke-width="16">
                                            </circle>
                                            <line x1="128" y1="32" x2="128" y2="96" fill="none" stroke="currentColor"
                                                stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line>
                                            <line x1="128" y1="160" x2="128" y2="224" fill="none" stroke="currentColor"
                                                stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line>
                                            <line x1="224" y1="128" x2="160" y2="128" fill="none" stroke="currentColor"
                                                stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line>
                                            <line x1="96" y1="128" x2="32" y2="128" fill="none" stroke="currentColor"
                                                stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line>
                                            <line x1="195.88" y1="60.12" x2="150.63" y2="105.37" fill="none"
                                                stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                                stroke-width="16"></line>
                                            <line x1="105.37" y1="150.63" x2="60.12" y2="195.88" fill="none"
                                                stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                                stroke-width="16"></line>
                                            <line x1="195.88" y1="195.88" x2="150.63" y2="150.63" fill="none"
                                                stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                                stroke-width="16"></line>
                                            <line x1="105.37" y1="105.37" x2="60.12" y2="60.12" fill="none"
                                                stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                                stroke-width="16"></line>
                                        </svg>
                                        <!-- STANDING -->
                                        <svg *ngSwitchCase="'standing'" xmlns="http://www.w3.org/2000/svg" width="20"
                                            height="20" fill="currentColor" viewBox="0 0 256 256">
                                            <rect x="56" y="32" width="144" height="192" rx="8" fill="none"
                                                stroke-width="16"></rect>
                                            <line x1="56" y1="80" x2="200" y2="80" fill="none" stroke="currentColor"
                                                stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line>
                                            <line x1="104" y1="160" x2="152" y2="160" fill="none" stroke="currentColor"
                                                stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line>
                                        </svg>
                                        <!-- SPLIT (Default) -->
                                        <svg *ngSwitchDefault xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                            fill="currentColor" viewBox="0 0 256 256">
                                            <path
                                                d="M224,112V88a16,16,0,0,0-16-16H48A16,16,0,0,0,32,88v24a16,16,0,0,0,16,16h4.13A40,40,0,0,0,88,168h80a40,40,0,0,0,35.87-40H208A16,16,0,0,0,224,112ZM168,152H88a24,24,0,0,1-23.47-19.1A8.25,8.25,0,0,0,64,132a8,8,0,0,0-8-8H48V88H208v36h-8a8,8,0,0,0-8,8,8.25,8.25,0,0,0-.53.9A24,24,0,0,1,168,152Z">
                                            </path>
                                        </svg>
                                    </ng-container>
                                </div>
                                <p class="text-[8px] font-bold text-gray-400 mt-1 truncate w-full text-center">{{
                                    asset.sku }}</p>
                            </div>
                        </div>
                    </div>
                </ng-container>
            </div>
        </div>

        <!-- Empty State -->
        <div *ngIf="!loading && filteredAssets.length === 0"
            class="bg-white rounded-xl py-12 px-6 text-center border border-gray-200">
            <h3 class="text-lg font-bold text-gray-400">Tidak ada aset ditemukan</h3>
            <p class="text-sm text-gray-400 mt-1">Coba sesuaikan filter pencarian atau lokasi Anda.</p>
        </div>

    </div>

    <!-- DISPOSAL MODAL -->
    <div *ngIf="showDisposalModal"
        class="fixed inset-0 z-[60] flex items-center justify-center p-4 bg-gray-900/50 backdrop-blur-sm animate-fade-in">
        <div class="bg-white rounded-3xl w-full max-w-md shadow-2xl overflow-hidden">
            <div class="p-6 md:p-8">
                <h3 class="text-xl font-black text-gray-900 mb-1">Konfirmasi Penghapusan Aset</h3>
                <p class="text-gray-500 font-medium text-sm mb-6">Proses ini akan menonaktifkan aset secara permanen.
                </p>

                <form [formGroup]="disposalForm" (ngSubmit)="submitDisposal()" class="space-y-4">

                    <div class="space-y-1.5">
                        <label class="text-[10px] font-black text-gray-400 uppercase tracking-widest ml-1">Jenis
                            Penghapusan</label>
                        <select formControlName="disposal_type"
                            class="w-full px-4 py-3 rounded-xl border border-gray-200 font-bold text-sm bg-white">
                            <option value="scrapped">Scrapped (Dimusnahkan/Rongsok)</option>
                            <option value="sold">Sold (Dijual/Lelang)</option>
                            <option value="lost">Lost (Hilang)</option>
                            <option value="donated">Donated (Hibah)</option>
                        </select>
                    </div>

                    <div class="space-y-1.5">
                        <label class="text-[10px] font-black text-gray-400 uppercase tracking-widest ml-1">Nilai Jual /
                            Residu (Rp)</label>
                        <input formControlName="sale_price" type="number"
                            class="w-full px-4 py-3 rounded-xl border border-gray-200 font-bold text-sm">
                    </div>

                    <div class="space-y-1.5">
                        <label class="text-[10px] font-black text-gray-400 uppercase tracking-widest ml-1">Catatan
                            Tambahan</label>
                        <textarea formControlName="notes" rows="3"
                            class="w-full px-4 py-3 rounded-xl border border-gray-200 font-bold text-sm"></textarea>
                    </div>

                    <div class="flex gap-3 pt-4">
                        <button type="button" (click)="closeDisposalModal()"
                            class="flex-1 py-3 rounded-xl font-bold text-gray-500 hover:bg-gray-50 transition-colors">
                            Batal
                        </button>
                        <button type="submit" [disabled]="isSubmitting"
                            class="flex-1 py-3 rounded-xl bg-red-600 hover:bg-red-700 text-white font-bold transition-colors disabled:opacity-50">
                            {{ isSubmitting ? 'Memproses...' : 'Konfirmasi' }}
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

</div>